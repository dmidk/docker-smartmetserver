#
# Q3 PRODUCTION CONFIGURATION
#
# 'log':    "stderr"
#           "syslog user|daemon|local0..local7" (facility name)
#
# 'package_path':   Where to look for source addons (like LUA_PATH)
# 'package_cpath':  Where to look for binary addons (like LUA_CPATH)
#                   <http://www.lua.org/manual/5.1/manual.html#pdf-package.path>
#                   <http://www.lua.org/manual/5.1/manual.html#pdf-package.cpath>
#               
# 'killtime': max time for a script to run (global only)
# 'testbed': location of online testbed file (global only)
# 'refresh': time in between data refreshes ('false' for none)
# 'runs':   hours between model runs (3h/6h/12h/none); affects how use of
#           negative origintimes (-1,-2,...) behaves.
# 'rootdir': path prepended to file masks (unless they start with '/') (global only)
#
# Filters are given under the name of their producer (s.a. 'HIR= {') which
# can be used in fetches to focus the fetch on some producer(s) only.
#
# Defaults can be given either at the global level, or within a producer id's
# subtable. They must be before the filter items they are to affect.
#
# With archives, file paths should contain "/**/" to mark a discontinuity
# between parent path and actual file mask (usually '*.sqd.bz2"). This is
# because the existing KAP archiving uses directory levels s.a. 2007/200705/.
#
# NOTE: 
#   This configuration is used as is ('/etc/q3server/q3server.conf') for the standalone
#   q3 server. It is used slightly modified ('/etc/brainstorm/plugins/q3plugin.conf') for
#   Brainstorm q3 plugin (logging is directed to different syslog category, to allow both
#   instances to coexist - in different ports).     --AKa 11-May-10
#

#---
# Note: Brainstorm directs 'stderr' to '/smartmet/logs/brainstorm'
#
# q3server uses:    syslog local1
# q3plugin uses:    syslog local2
# debugging uses:   stderr
#
log=syslog local1

# Note: 'q3server-addons/?.lua' matches also 'areamask.xxx' -> 'q3server-addons/areamask/xxx.lua'
#
package_path=/usr/share/lua/5.1/q3server-addons/?.lua;/usr/share/lua/5.1/q3server-addons/?/?.lua
package_cpath=/usr/lib64/lua/5.1/q3server-addons/?.so

killtime= 20sec
testbed= /usr/share/q3plugin/testbed.html
refresh= 3min
rootdir= /smartmet/

cache= /tmp/q3cache

#---
# Health check reports sent periodically to the logging service.
#
# healthcheck(x.x)= [cpu] [mem] [swap] [<path>] [...]
#
# x.x:  time between the logs ([Xh][YYmin][ZZsec])
# cpu:  track cpu usage
# mem:  memory usage
# swap: swap usage
# path: track usage of the mount for the particular folder
#
# There may be multiple healthcheck lines, to perform different checks with
# different intervals.
#
healthcheck(3min)= *
healthcheck(60min)= / /smartmet/data /smartmet/brainstorm /smartmet/archive

#--
# Available data
#
HIR {
    runs= 6h     # UTC 00,06,12,18
    { data/hirlam/eurooppa/pinta/querydata/*_hirlam_eurooppa_pinta.sqd }
    { data/hirlam/eurooppa/painepinta/querydata/*.sqd }
    { data/hirlam/eurooppa/mallipinta/querydata/*_hirlam_eurooppa_mallipinta.sqd }
}

EC {
    runs= 12h    # UTC 00,12
    { brainstorm/ecmwf/pinta/*_ecmwf_pinta.sqd }
    { brainstorm/ecmwf/painepinta/*_ecmwf_painepinta.sqd }
    { brainstorm/ecmwf/mallipinta/ecmwf_mallipinta_*.sqd }
#    { archive/fmi/querydata/ecmwf/skandinavia/pinta/**/*.sqd.bz2 }
#    { archive/fmi/querydata/ecmwf/skandinavia/painepinta/**/*.sqd.bz2 }
}

EC3VRK {
    runs= 12h    # UTC 00,12
    { brainstorm/ecmwf/pinta3vrk/*_ecmwf_pinta_3vrk.sqd }
    { brainstorm/ecmwf/painepinta3vrk/*_ecmwf_painepinta_3vrk.sqd }
}

GFS {
    runs= 6h     # UTC 00,06,12,18
    { data/gfs/world/surface/querydata/*_gfs_world_surface.sqd }
    { data/gfs/europe/pressure/querydata/*_gfs_europe_pressure.sqd }
}

MEPS {
    runs= 6h
    { data/metcoop/scandinavia/control/surface/querydata/*.sqd }
    { data/metcoop/scandinavia/control/pressure/querydata/*.sqd }
    { data/metcoop/scandinavia/control/hybrid/querydata/*.sqd }
}

LAPS {
    runs= 1h
    { brainstorm/laps/laps_scand_combined/laps_skandinavia_*.sqd }
}

LAPS_PRESS {
    runs= 1h
    { brainstorm/laps/laps_scand_pressure_combined/laps_pressure_skandinavia_*.sqd  }
}

# Oli "*_arome_etelasuomi_pinta.sqd" mutta levyllä on nykyään "*_arome_suomi_pinta.sqd"
#   --AKa 17-Mar-10
#
ARO {
    runs= 6h    # UTC 00,06,12,18
    #{ brainstorm/arome/pinta/*_arome_suomi_pinta.sqd }
    #{ brainstorm/arome/mallipinta/*_arome_suomi_mallipinta.sqd }
   { data/metcoop/scandinavia/control/surface/querydata/*.sqd }
   { data/metcoop/scandinavia/control/pressure/querydata/*.sqd }
   { data/metcoop/scandinavia/control/hybrid/querydata/*.sqd }
}

# Jalankulkumalli, added 2011-07-25, MikkoV
JKM_NOIC {
    runs= 6h     # depends on HIRLAM
    { brainstorm/suomi/jalankulku_noic/*.sqd }
}

JKM_WIC {
    runs= 6h     # depends on HIRLAM
    { brainstorm/suomi/jalankulku_wic/*.sqd }
}

#---
# Data for Climate guide (xq3.fmi.fi)
#
# /var/q3data/il/
#   A1B.multi_model_mean.t_p.sqd
#   A2.multi_model_mean.t_p.sqd
#   B1.multi_model_mean.t_p.sqd
#   OBS.t_p.sqd
#   skenaario_a1b.sqd
#   skenaario_a2.sqd
#   skenaario_b1.sqd
#
# /var/q3data/syke/
#
#   A1FI.multi_model_mean.energy_coolingdegreedays.sqd
#   A1FI.multi_model_mean.energy_heatingdegreedays.sqd
#   A1FI.multi_model_mean.hydro_runoffmaxaverage.sqd
#   A1FI.multi_model_mean.hydro_runoffsumaverage.sqd
#   A1FI.multi_model_mean.hydro_snowcoverdays.sqd
#
#   A2.multi_model_mean.energy_coolingdegreedays.sqd
#   A2.multi_model_mean.energy_heatingdegreedays.sqd
#   A2.multi_model_mean.hydro_runoffmaxaverage.sqd
#   A2.multi_model_mean.hydro_runoffsumaverage.sqd
#   A2.multi_model_mean.hydro_snowcoverdays.sqd
#
#   B1.multi_model_mean.energy_coolingdegreedays.sqd
#   B1.multi_model_mean.energy_heatingdegreedays.sqd
#   B1.multi_model_mean.hydro_runoffmaxaverage.sqd
#   B1.multi_model_mean.hydro_runoffsumaverage.sqd
#   B1.multi_model_mean.hydro_snowcoverdays.sqd
#
#   B2.multi_model_mean.energy_coolingdegreedays.sqd
#   B2.multi_model_mean.energy_heatingdegreedays.sqd
#   B2.multi_model_mean.hydro_runoffmaxaverage.sqd
#   B2.multi_model_mean.hydro_runoffsumaverage.sqd
#   B2.multi_model_mean.hydro_snowcoverdays.sqd
#
# Note: Eventually, we can do things like 'A1FI_<model>' for accessing particular
# models (to be 18 of them) within the scenario.
#
A1B {
    { /var/q3data/il/A1B.multi_model_mean.*.sqd }
}
A1FI {
    { /var/q3data/il/A1FI.multi_model_mean.*.sqd }
    { /var/q3data/syke/A1FI.multi_model_mean.*.sqd }
}
A2 {
    { /var/q3data/il/A2.multi_model_mean.*.sqd }
    { /var/q3data/syke/A2.multi_model_mean.*.sqd }
}
B1 {
    { /var/q3data/il/B1.multi_model_mean.*.sqd }
    { /var/q3data/syke/B1.multi_model_mean.*.sqd }
}
B2 {
    { /var/q3data/syke/B2.multi_model_mean.*.sqd }
}
OBS {
    { /var/q3data/il/OBS.*.sqd }
}

TOPO {
    { data/topografia/Topografia_HIRLAM_RCR.sqd }
    { data/topografia/Topografia_ECMWF.sqd }
}

HAV {
   { data/havy/suomi/synop/querydata/*_havy_suomi_synop.sqd }
}

WWI {
   { data/fmi/eurooppa/wwi/querydata/*.sqd }
}

WAWE {
   runs= 24h
   { data/ecmwf/eurooppa/aalto120h/querydata/*_ecmwf_eurooppa_aalto120h.sqd }
}

KAP {
  { data/pal/skandinavia/pinta/querydata/*_pal_skandinavia_pinta.sqd }
}

EC_SOUNDING_INDEX {
  runs=6h
  { data/ecmwf/eurooppa/soundingindex/querydata/*_ecmwf_eurooppa_soundingindex.sqd }
}


HIR_SOUNDING_INDEX {
  runs=12h
  { data/hirlam/eurooppa/soundingindex/querydata/*_hirlam_eurooppa_soundingindex.sqd }
}

HAR_SOUNDING_INDEX {
  runs=6h
  { data/metcoop/scandinavia/control/soundingindex/querydata/*.sqd }
}

MEPS_SOUNDING_INDEX {
  runs=6h
  { data/metcoop/scandinavia/control/soundingindex/querydata/*.sqd }
}

EUR_SOUNDING_OBS {
  { data/havy/eurooppa/luotaus/querydata/*_havy_eurooppa_luotaus.sqd }
}

ROAD_MODEL {
  { data/roadmodel/skandinavia/pinta/querydata/*.sqd }
}
